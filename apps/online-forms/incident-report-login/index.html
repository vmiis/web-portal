<!DOCTYPE html>
<html>
    <head>
        <title>Web Data Collection Form</title>
        <meta name='viewport' content='width=device-width, initial-scale=1'>
        <link rel="icon" href="data:,">
        <link rel="stylesheet" href="site.css" />
    </head>
    <body>
        <div id=header>
            <div id=logo>
                <span id=logo_a>Business</span><br>
                <span id=logo_b>Data Collection</span>
            </div>
            <div id=top_right>
                <u id=vm_auth_u onclick="vm_auth(this)">Sign In</u>
            </div>
        </div>
        <div id=layout>
            <div id=content></div>
            <div id=footer>
                Open Source Code: <u><a target=_blank style='color:#fff' href=https://github.com/vmiis/web-portal >https://github.com/vmiis/web-portal</a></u>
            </div>
        </div>
    </body>
    <script>
        var client_id='f39f8959-8cd7-4570-8c0f-548306bf899a';  //vmiis
        function vm_auth(){var n=0,t=sessionStorage.getItem("id_token");if(t!=null){var i=t.split(".")[1],r=i.replace(/-/g,"+").replace(/_/g,"/"),u=decodeURIComponent(atob(r).split("").map(function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)}).join("")),f=JSON.parse(u),e=f.exp;Date.now()<e*1e3&&(n=1)}n==0?(url="https://login.microsoftonline.com/common/oauth2/v2.0/authorize",url+="?client_id="+client_id,url+="&response_type=id_token",url+="&redirect_uri="+window.location.origin+"/auth.html",url+="&scope=openid user.read profile",url+="&response_mode=fragment",url+="&state=exchange-microsoft-token.wapp_microsoft",url+="&nonce=678910",url+="&prompt=select_account",window.open(url)):(sessionStorage.removeItem("id_token"),document.getElementById("vm_auth_u").textContent="Sign in")}var __vm_print__=0,doc;window.onbeforeprint=function(){__vm_print__=1};window.onafterprint=function(){__vm_print__=0};doc=document.getElementById("content");xhttp=new XMLHttpRequest;xhttp.onreadystatechange=function(){var r,i,n,t;if(this.readyState==4){if(this.status==200){doc.innerHTML=this.responseText;r=document.getElementsByTagName("head")[0];n=doc.getElementsByTagName("script");for(t in n)i=document.createElement("script"),i.type="text/javascript",n[t].text!=undefined&&(i.text=n[t].text),n[t].src!=undefined&&n[t].src!=""&&(i.src=n[t].src),(n[t].src!=undefined&&n[t].src!=""||n[t].text!=undefined)&&r.appendChild(i)}this.status==404&&(doc.innerHTML="Page not found.")}};xhttp.open("GET","form.html",!0);xhttp.send();window.onscroll=function(){var t=-window.scrollY/2,n=-t/100;n>.5&&(n=.5);document.getElementById("header").style.background="rgba(0,0,0,"+n+")"};window.onmessage=function(n){if(n.origin==window.location.origin){var t=n.data.href.split("id_token=").pop().split("&")[0];sessionStorage.setItem("id_token",t);document.getElementById("vm_auth_u").textContent="Sign out"}}
    </script>
    <style>
        body{
            background-image: url(https://images.unsplash.com/photo-1469967700385-5b0140e16e33?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80);
        }
    </style>
    <style>
        #auth{
            color:#fff;
        }
    </style>
</html>