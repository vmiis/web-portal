<div id=D__ID>
    <script>
        function F__ID(){
            //-------------------------------------------------------------------------------------------------------
            $vm.microsoft_query=function(UID,ID1,ID2,ID3){
                //-------------------------------------
                $vm.request({api:'wapp',cmd:"find",table:"woolcock-dynamics-365-query",query:{UID:UID},options:{}},function(res){
                    var records=res.result;
                    if(records!=undefined && records.length==1){
                        var dhost='woolcock.crm6.dynamics.com';
                        var host=records[0].Data.Host;  if(host==undefined) host=dhost;
                        var name=records[0].Data.Name;
                        var path=records[0].Data.Path;
                        var array=records[0].Data.Array;
                        var columns=records[0].Data.Columns;
                        $vm.get_microsoft_token(host,function(t){
                            if(t!=""){
                                if(path.indexOf('[INPUT]')!=-1){
                                    var p=prompt("Input", "");
                                    if(p==null) return;
                                    path=path.replace('[INPUT]',p);
                                }
                                if(ID1!=undefined) path=path.replace('\[ID1\]',ID1);
                                if(ID2!=undefined) path=path.replace('\[ID2\]',ID2);
                                if(ID3!=undefined) path=path.replace('\[ID3\]',ID3);
                                path=path.replace(/\n/g,'').replace(/\r/g,'');
                                path=encodeURI(path);
                                if(path.indexOf("$top=")==-1 && path.indexOf("$count=true")!=-1 ) $vm.show_module('microsoft-data',{name:name,path:path,array:array,columns:columns})
                                else{
                                    $vm.request({api:'wapp',cmd:'microsoft-api',access_token:t,host:host,path:path},function(res){
                                        var v=res.result;
                                        if(res.status=="err"){
                                            $vm.show_module('jsonv',{json_data:v})
                                        }
                                        if(array!=""){
                                            var type=columns.indexOf('|');
                                            if(type!=-1){
                                                if(ID1==undefined) $vm.show_module('gridv',{name:name,json_data:JSON.parse(v),array:array,columns:columns,ID1:ID1,ID2:ID2,ID3:ID3})
                                                else if(ID2==undefined) $vm.show_module('gridv2',{name:name,json_data:JSON.parse(v),array:array,columns:columns,ID1:ID1,ID2:ID2,ID3:ID3})
                                                else if(ID3==undefined) $vm.show_module('gridv3',{name:name,json_data:JSON.parse(v),array:array,columns:columns,ID1:ID1,ID2:ID2,ID3:ID3})
                                            }
                                            else $vm.show_module('arrayv',{name:name,json_data:JSON.parse(v),array:array,columns:columns})
                                        }
                                        else{
                                            $vm.show_module('jsonv',{json_data:JSON.parse(v)})
                                        }
                                    })
                                }
                            }
                        });
                    }
                    else alert('No report.')
                })
            }
            //-------------------------------------------------------------------------------------------------------
            $vm.intuit_query=function(UID){
                $vm.request({api:'wapp',cmd:"find",table:"intuit-api",query:{UID:UID},options:{}},function(res){
                    var records=res.result;
                    if(records!=undefined && records.length==1){
                        var name=records[0].Data.Name;
                        var array=records[0].Data.Array;
                        var columns=records[0].Data.Columns;
                        var path=encodeURI(records[0].Data.Path);
                        $vm.get_intuit_token(function(realmId,t){
                            var path2="/v3/company/"+realmId+path;
                            $vm.request({api:'wapp',cmd:'intuit-api',access_token:t,path:path2},function(res){
                                var v=JSON.parse(res.result);
                                if(res.status=="err"){
                                    $vm.show_module('jsonv',{json_data:v})
                                }
                                else if(array!=""){
                                    var type=columns.indexOf('|');
                                    if(type!=-1) $vm.show_module('gridv',{name:name,json_data:v,array:array,columns:columns})
                                    else $vm.show_module('arrayv',{name:name,json_data:v,array:array,columns:columns})
                                }
                                else{
                                    $vm.show_module('jsonv',{json_data:v})
                                }
                            })
                        })
                    }
                    else alert('No report.')
                })
            }
            //-------------------------------------------------------------------------------------------------------
            $vm.youtube_query=function(UID){
                $vm.request({api:'wapp',cmd:"find",table:"youtube",query:{UID:UID},options:{}},function(res){
                    var records=res.result;
                    if(records!=undefined && records.length==1){
                        var src=records[0].Data.Src;
                        $vm.show_module('youtube',{src:src})
                    }
                    else alert('No video was found.')
                })
            }
            //-------------------------------------------------------------------------------------------------------
        }
    </script>   
</div>